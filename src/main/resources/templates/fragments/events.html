
<div th:fragment="content">
    <div class="page-header">
        <div class="breadcrumbs">
            <span class="link" data-link="host" style="cursor:pointer">B·∫£ng ƒëi·ªÅu khi·ªÉn</span>
            <i class="fas fa-chevron-right"></i>
            <span>S·ª± ki·ªán</span>
        </div>
        <div class="header-content">
            <h1 class="page-title">S·ª± ki·ªán</h1>
            <button class="btn-share">
                <i class="fas fa-share-alt"></i>
                <span>Chia s·∫ª</span>
            </button>
        </div>
    </div>

    <div class="event-search-bar">
        <input type="text" class="event-search-input" placeholder="T√¨m ki·∫øm theo t√™n s·ª± ki·ªán"/>
        <select class="event-search-select">
            <option>T·∫•t c·∫£</option>
            <option>ƒêang di·ªÖn ra</option>
            <option>S·∫Øp di·ªÖn ra</option>
            <option>ƒê√£ k·∫øt th√∫c</option>
            <option>Oldest first</option>
        </select>
        <button class="btn-create-event">
            <i class="fas fa-calendar-plus"></i> T·∫°o s·ª± ki·ªán
        </button>
    </div>

    <div class="event-tabs">
        <button class="event-tab active">S·∫Øp t·ªõi</button>
        <button class="event-tab">K·∫øt th√∫c</button>
        <button class="event-tab">L∆∞u tr·ªØ</button>
    </div>

    <div class="events-list">
        <div class="event-card" th:each="event : ${events}">
            <div class="event-image">
                <img alt="Event Image"
                     th:src="${event.imageUrl}"
                     src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='60'%3E%3Crect width='100%25' height='100%25' fill='%236f42c1'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' fill='white' font-family='Segoe UI' font-size='12'%3EEvent%3C/text%3E%3C/svg%3E">
            </div>
            <div class="event-details">
                <h3 class="event-title" th:text="${event.title}">T√™n S·ª± Ki·ªán</h3>

                <p class="event-subtitle" th:text="${event.eventType}">Lo·∫°i S·ª± Ki·ªán</p>

                <div class="event-info">
                    <span class="date-box" th:text="${#temporals.format(event.startsAt, 'MMM dd')}"></span>

                    <span class="time"
                          th:text="|${#temporals.format(event.startsAt, 'h:mm a')} - ${#temporals.format(event.endsAt, 'h:mm a')}|">9:00 PM - 11:00 PM</span>

                    <span th:classappend="${event.status.name() == 'DRAFT' ? 'draft' : 'live'}"
                          class="status-badge"
                          th:text="${event.status.name() == 'DRAFT' ? 'DRAFT ‚Ä¢ S·∫ÆP T·ªöI' : 'LIVE ‚Ä¢ ƒêANG DI·ªÑN RA'}">DRAFT ‚Ä¢ S·∫ÆP T·ªöI</span>
                </div>

                <div class="event-sales">
                    <i class="fas fa-users"></i>
                    <span th:text="|0 ƒë√£ b√°n|">0 ƒë√£ b√°n</span>
                </div>
            </div>
            <div class="event-actions">
                <button class="action-btn" th:attr="data-event-id=${event.id}">
                    <i class="fas fa-ellipsis-v"></i>
                </button>

                <div class="dropdown-menu" style="display: none;">
                    <ul>
                        <li>
                            <a th:href="@{'/event/' + ${event.id}}">
                                <i class="far fa-eye"></i> Xem trang s·ª± ki·ªán
                            </a>
                        </li>
                        <li>
                            <a th:href="@{'/manage/event/' + ${event.id}+'/getting-stared'}">
                                <i class="fas fa-cog"></i> Qu·∫£n l√Ω s·ª± ki·ªán
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fas fa-qrcode"></i> Check-in
                            </a>
                        </li>
                        <li>
                            <a href="#" class="delete-action">
                                <i class="fas fa-trash-alt"></i> L∆∞u tr·ªØ s·ª± ki·ªán
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="createEventModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>

            <h2>‚ú® T·∫°o s·ª± ki·ªán c·ªßa b·∫°n</h2>
            <p class="subtitle">H√£y cho ch√∫ng t√¥i bi·∫øt v·ªÅ s·ª± ki·ªán c·ªßa b·∫°n</p>

            <form th:action="@{/api/events/saveEvent}" th:object="${eventForm}" method="post">
                <label>T√™n s·ª± ki·ªán *</label>
                <input type="text" th:field="*{title}" placeholder="Nh·∫≠p t√™n s·ª± ki·ªán">

                <label>Th·ªÉ lo·∫°i s·ª± ki·ªán</label>
                <select th:field="*{eventType}">
                    <option th:each="p : ${listTypeEvent}" th:value="${p}" th:text="${p}"></option>
                </select>

                <label>M√¥ t·∫£ s·ª± ki·ªán</label>
                <textarea th:field="*{description}"
                          placeholder="H√£y cho m·ªçi ng∆∞·ªùi bi·∫øt ƒëi·ªÅu g√¨ s·∫Ω c√≥ t·∫°i s·ª± ki·ªán..."></textarea>

                <div>
                    <label>H·∫°n ƒëƒÉng k√Ω s·ª± ki·ªán</label>
                    <input th:field="*{enrollDeadline}" type="datetime-local">
                </div>

                <div class="date-time">
                    <div>
                        <label>Ng√†y & gi·ªù b·∫Øt ƒë·∫ßu *</label>
                        <input th:field="*{startsAt}" type="datetime-local">
                    </div>
                    <div>
                        <label>Ng√†y & gi·ªù k·∫øt th√∫c</label>
                        <input th:field="*{endsAt}" type="datetime-local">
                    </div>
                </div>

                <button type="submit" class="submit-btn">üìÖ Ti·∫øp t·ª•c thi·∫øt l·∫≠p</button>
            </form>
        </div>
    </div>

</div>

<script>
    // Modal functionality
    document.addEventListener('DOMContentLoaded', function () {
        const modal = document.getElementById('createEventModal');
        const openBtn = document.querySelector('.btn-create-event');
        const closeBtn = document.querySelector('.close');

        // Open modal
        if (openBtn) {
            openBtn.addEventListener('click', function () {
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });
        }

        // Close modal
        function closeModal() {
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        if (closeBtn) {
            closeBtn.addEventListener('click', closeModal);
        }

        // Close modal when clicking outside
        window.addEventListener('click', function (event) {
            if (event.target === modal) {
                closeModal();
            }
        });

        // Form validation
        const form = document.querySelector('form');
        if (form) {
            form.addEventListener('submit', function (e) {
                const title = document.querySelector('input[th\\:field="*{title}"]');
                const startsAt = document.querySelector('input[th\\:field="*{startsAt}"]');

                if (!title.value.trim()) {
                    e.preventDefault();
                    alert('Vui l√≤ng nh·∫≠p t√™n s·ª± ki·ªán');
                    title.focus();
                    return;
                }

                if (!startsAt.value) {
                    e.preventDefault();
                    alert('Vui l√≤ng ch·ªçn ng√†y v√† gi·ªù b·∫Øt ƒë·∫ßu');
                    startsAt.focus();
                    return;
                }
            });
        }

        // Dropdown menu functionality

    });
</script>

